<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>Grijper: phidget_reader.cpp File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">phidget_reader.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;ros/ros.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;std_msgs/Float32.h&gt;</code><br/>
<code>#include &lt;std_msgs/String.h&gt;</code><br/>
<code>#include &lt;std_msgs/Bool.h&gt;</code><br/>
<code>#include &lt;string&gt;</code><br/>
<code>#include &lt;phidget_ik/phidget_ik.h&gt;</code><br/>
<code>#include &lt;<a class="el" href="command_8h_source.html">Grijper/command.h</a>&gt;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for phidget_reader.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="phidget__reader_8cpp__incl.png" border="0" usemap="#phidget__reader_8cpp" alt=""/></div>
<map name="phidget__reader_8cpp" id="phidget__reader_8cpp">
<area shape="rect" id="node17" href="command_8h.html" title="Grijper/command.h" alt="" coords="909,83,1040,112"/></map>
</div>
</div>
<p><a href="phidget__reader_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phidget__reader_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="memdesc:a3c04138a5bfe5d72780bb7e82a18e627"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main method reading the phidget at a specified frequency and smoothing the signal before passing it on.  <a href="#a3c04138a5bfe5d72780bb7e82a18e627">More...</a><br/></td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a478ef96a3ad4032e1f91152178c8809e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phidget__reader_8cpp.html#a478ef96a3ad4032e1f91152178c8809e">mean</a> ()</td></tr>
<tr class="memdesc:a478ef96a3ad4032e1f91152178c8809e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method for calulating the mean of the buffer to pass on to the controller.  <a href="#a478ef96a3ad4032e1f91152178c8809e">More...</a><br/></td></tr>
<tr class="separator:a478ef96a3ad4032e1f91152178c8809e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09b9cf5195215cdfaa34111afd03c8a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phidget__reader_8cpp.html#a09b9cf5195215cdfaa34111afd03c8a8">printbuffer</a> ()</td></tr>
<tr class="memdesc:a09b9cf5195215cdfaa34111afd03c8a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">A small control method to print the buffer.  <a href="#a09b9cf5195215cdfaa34111afd03c8a8">More...</a><br/></td></tr>
<tr class="separator:a09b9cf5195215cdfaa34111afd03c8a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8564fe398b4af80bdf3877410ffcbc67"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phidget__reader_8cpp.html#a8564fe398b4af80bdf3877410ffcbc67">sensorToDistance</a> (int sensorValue)</td></tr>
<tr class="memdesc:a8564fe398b4af80bdf3877410ffcbc67"><td class="mdescLeft">&#160;</td><td class="mdescRight">simple calculation method to extract a distance from the sensor value.  <a href="#a8564fe398b4af80bdf3877410ffcbc67">More...</a><br/></td></tr>
<tr class="separator:a8564fe398b4af80bdf3877410ffcbc67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3f7db7de2a2af54619cd7ac3517b924"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phidget__reader_8cpp.html#ab3f7db7de2a2af54619cd7ac3517b924">shiftBuffer</a> (int data)</td></tr>
<tr class="memdesc:ab3f7db7de2a2af54619cd7ac3517b924"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method for shifting the buffer and inserting the newest sensor value.  <a href="#ab3f7db7de2a2af54619cd7ac3517b924">More...</a><br/></td></tr>
<tr class="separator:ab3f7db7de2a2af54619cd7ac3517b924"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6099bcde46c020c0703be2c28a4432d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phidget__reader_8cpp.html#a6099bcde46c020c0703be2c28a4432d5">shutdown</a> (const std_msgs::Bool::ConstPtr &amp;b)</td></tr>
<tr class="memdesc:a6099bcde46c020c0703be2c28a4432d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Controll method to shutdown this ROS node when the command is given.  <a href="#a6099bcde46c020c0703be2c28a4432d5">More...</a><br/></td></tr>
<tr class="separator:a6099bcde46c020c0703be2c28a4432d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a87f0aec3ac049be255616effe0efdc43"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phidget__reader_8cpp.html#a87f0aec3ac049be255616effe0efdc43">buffer</a> [<a class="el" href="phidget__reader_8cpp.html#a9bd822a4ae927624f7827c898422d1db">buffer_size</a>]</td></tr>
<tr class="separator:a87f0aec3ac049be255616effe0efdc43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd822a4ae927624f7827c898422d1db"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phidget__reader_8cpp.html#a9bd822a4ae927624f7827c898422d1db">buffer_size</a> = 25</td></tr>
<tr class="separator:a9bd822a4ae927624f7827c898422d1db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a323a9f2cf2eeae7e0acd9fe48da80fff"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phidget__reader_8cpp.html#a323a9f2cf2eeae7e0acd9fe48da80fff">freq</a> = 250</td></tr>
<tr class="separator:a323a9f2cf2eeae7e0acd9fe48da80fff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdd8c9ca04f3c952e0a17260cfa8f2eb"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phidget__reader_8cpp.html#acdd8c9ca04f3c952e0a17260cfa8f2eb">sensor_id</a> = 4</td></tr>
<tr class="separator:acdd8c9ca04f3c952e0a17260cfa8f2eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main method reading the phidget at a specified frequency and smoothing the signal before passing it on. </p>
<p>Here the phidget is read at a fixed interval, given by freq. These values are stored in the buffer and sliding mean smoothing is applied. This ensures a less spikey signal for the controller and impulses are filtered out. This also means that the system has a longer response time, but by increasing the frequency this is nullified. The buffer acts as a queue, shifting the values every time before calculating a mean value to pass on to the controller. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="phidget__reader_8cpp.html#ab3f7db7de2a2af54619cd7ac3517b924" title="Method for shifting the buffer and inserting the newest sensor value.">shiftBuffer(int)</a>, <a class="el" href="phidget__reader_8cpp.html#a478ef96a3ad4032e1f91152178c8809e" title="Method for calulating the mean of the buffer to pass on to the controller.">mean()</a> </dd></dl>

<p>Definition at line <a class="el" href="phidget__reader_8cpp_source.html#l00032">32</a> of file <a class="el" href="phidget__reader_8cpp_source.html">phidget_reader.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a478ef96a3ad4032e1f91152178c8809e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mean </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method for calulating the mean of the buffer to pass on to the controller. </p>
<p>This method calculated the mean of the values in the buffer. </p>
<dl class="section return"><dt>Returns</dt><dd>The calculated mean. </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="phidget__reader_8cpp.html#ab3f7db7de2a2af54619cd7ac3517b924" title="Method for shifting the buffer and inserting the newest sensor value.">shiftBuffer(int)</a> </dd></dl>

<p>Definition at line <a class="el" href="phidget__reader_8cpp_source.html#l00097">97</a> of file <a class="el" href="phidget__reader_8cpp_source.html">phidget_reader.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a09b9cf5195215cdfaa34111afd03c8a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printbuffer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A small control method to print the buffer. </p>
<p>Prints the buffer for each iteration so the calculated mean value can be evaluated. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="phidget__reader_8cpp.html#a478ef96a3ad4032e1f91152178c8809e" title="Method for calulating the mean of the buffer to pass on to the controller.">mean()</a> </dd></dl>

<p>Definition at line <a class="el" href="phidget__reader_8cpp_source.html#l00111">111</a> of file <a class="el" href="phidget__reader_8cpp_source.html">phidget_reader.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a8564fe398b4af80bdf3877410ffcbc67"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float sensorToDistance </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sensorValue</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>simple calculation method to extract a distance from the sensor value. </p>
<p>This method converts the sersorvalue to a distance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sensorValue</td><td>The value of the sensor. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The calculated distance. </dd></dl>

<p>Definition at line <a class="el" href="phidget__reader_8cpp_source.html#l00127">127</a> of file <a class="el" href="phidget__reader_8cpp_source.html">phidget_reader.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="ab3f7db7de2a2af54619cd7ac3517b924"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shiftBuffer </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method for shifting the buffer and inserting the newest sensor value. </p>
<p>This method shifts all the data elements in the buffer to make place for the new sensor data. The buffer is initialised as an array filled with '1', so the first buffer_size values will be invalid. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>The new sensor value to be shifted into the buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="phidget__reader_8cpp.html#a478ef96a3ad4032e1f91152178c8809e" title="Method for calulating the mean of the buffer to pass on to the controller.">mean()</a> </dd></dl>

<p>Definition at line <a class="el" href="phidget__reader_8cpp_source.html#l00084">84</a> of file <a class="el" href="phidget__reader_8cpp_source.html">phidget_reader.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a6099bcde46c020c0703be2c28a4432d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void shutdown </td>
          <td>(</td>
          <td class="paramtype">const std_msgs::Bool::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Controll method to shutdown this ROS node when the command is given. </p>
<p>This method will shutdown this node when the command is given by the console. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">b</td><td>The message containing the command. Nothing is done with the command since we know what it will be when this message is received. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a87f0aec3ac049be255616effe0efdc43"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int buffer[<a class="el" href="phidget__reader_8cpp.html#a9bd822a4ae927624f7827c898422d1db">buffer_size</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The buffer used for smoothing. </p>

<p>Definition at line <a class="el" href="phidget__reader_8cpp_source.html#l00021">21</a> of file <a class="el" href="phidget__reader_8cpp_source.html">phidget_reader.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a9bd822a4ae927624f7827c898422d1db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int buffer_size = 25</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Value buffer size for signal smoothing. </p>

<p>Definition at line <a class="el" href="phidget__reader_8cpp_source.html#l00020">20</a> of file <a class="el" href="phidget__reader_8cpp_source.html">phidget_reader.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="a323a9f2cf2eeae7e0acd9fe48da80fff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int freq = 250</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The frequency at which the sensor should be read and the value passed on. </p>

<p>Definition at line <a class="el" href="phidget__reader_8cpp_source.html#l00019">19</a> of file <a class="el" href="phidget__reader_8cpp_source.html">phidget_reader.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="acdd8c9ca04f3c952e0a17260cfa8f2eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int sensor_id = 4</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The sensor ID. </p>

<p>Definition at line <a class="el" href="phidget__reader_8cpp_source.html#l00018">18</a> of file <a class="el" href="phidget__reader_8cpp_source.html">phidget_reader.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://ros.org/wiki/Grijper">Grijper</a><br />
Author(s): Stijn van Schooten, Wybren ten Cate, Florens Kreuk, Jan Wymenga,Joris Coenen, Roy Groot</br />
<small>autogenerated on Wed Oct 2 2013 17:24:50</small>
</div>
</body>
</html>
